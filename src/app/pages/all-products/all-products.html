<main class="container mx-auto max-w-7xl px-4 md:px-6 lg:px-8">
  <section class="products my-5">
    <!-- Loading State -->
    @if (loading) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 items-stretch">
        @for (i of [1, 2, 3, 4, 5, 6, 7, 8]; track i) {
          <app-skeleton type="product-card"></app-skeleton>
        }
      </div>
    }

    <!-- Products Grid -->
    @if (!loading) {
      <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-8 items-stretch">
        @for (product of AllProducts ; track product._id) {
      <div
        class="product group relative overflow-hidden bg-white border border-gray-200 rounded-lg shadow-sm dark:bg-gray-800 dark:border-gray-700 p-5 flex flex-col justify-between text-center"
      >
        <a [routerLink]="['/details', product._id]">
          <!-- Image -->
          <img
            [src]="product.imageCover"
            alt="{{ product.title }}"
            class="w-full h-40 object-contain mb-4"
          />

          <!-- Category -->
          <p class="text-green-600 text-sm font-medium mb-1">
            {{ product.category.name }}
          </p>

          <!-- Title -->
          <h5
            class="text-lg font-semibold tracking-tight text-gray-900 dark:text-white mb-2 whitespace-nowrap overflow-hidden text-ellipsis"
          >
            {{ product.title }}
          </h5>

          <!-- Bottom wrapper -->
          <div class="mt-auto">
            <!-- Price + Rating -->
            <div
              class="price-rating flex justify-between my-4 px-4 transition-opacity duration-500 group-hover:opacity-0"
            >
              <span>{{ product.price }} EGP</span>
              <span>
                <i class="fa-solid fa-star text-yellow-400"></i>
                {{ product.ratingsAverage }}
              </span>
            </div>

            <!-- Button (takes space, hidden until hover) -->
          </div>
        </a>
        <button
          class="cursor-pointer btn w-full mx-auto bg-green-600 hover:bg-green-700 text-white px-5 py-3 rounded font-medium transform translate-y-6 opacity-0 transition-all duration-700 ease-in-out group-hover:translate-y-0 group-hover:opacity-100"
          (click)="addToCart(product._id)"
          >
          Add to cart
        </button>
        </div>
        }
      </div>
    }
  </section>
</main>

<main class="container mx-auto max-w-7xl px-4 md:px-6 lg:px-8 py-8">
  <div class="flex flex-col lg:flex-row items-start">
    <!-- LEFT: Product Image -->
    <div class="w-full lg:w-[30%] flex justify-center">
      <div class="relative rounded-lg p-4 w-full flex flex-col items-center">
        <div class="flex items-center justify-center w-full">
          <!-- Prev Button -->
          <button
            class="bg-white border border-gray-300 rounded-full p-2 mx-2 shadow hover:bg-green-600 hover:text-white transition"
            (click)="prevImage()"
            [disabled]="!product?.images || currentImageIndex === 0"
            aria-label="Previous image"
          >
            <i class="fa-solid fa-chevron-left"></i>
          </button>

          <!-- Main Image -->
          <img
            [src]="product?.images?.[currentImageIndex] || 'assets/default-image.png'"
            [alt]="product?.title || 'Product image'"
            class="w-80 h-80 object-contain rounded-lg"
          />

          <!-- Next Button -->
          <button
            class="bg-white border border-gray-300 rounded-full p-2 mx-2 shadow hover:bg-green-600 hover:text-white transition"
            (click)="nextImage()"
            [disabled]="
              !product?.images ||
              currentImageIndex === (product?.images?.length ?? 1) - 1
            "
            aria-label="Next image"
          >
            <i class="fa-solid fa-chevron-right"></i>
          </button>
        </div>

        <!-- Dots Navigation -->
        @if ((product?.images?.length ?? 0) > 1) {
        <div class="flex justify-center mt-4 space-x-2">
          @for (image of product?.images ?? []; track i; let i = $index) {
          <button
            (click)="currentImageIndex = i"
            [class]="
              'w-3 h-3 rounded-full transition-colors ' +
              (i === currentImageIndex ? 'bg-green-500' : 'bg-gray-300')
            "
            [attr.aria-label]="'View image ' + (i + 1)"
          ></button>
          }
        </div>
        }
      </div>
    </div>

    <!-- RIGHT: Product Details -->
    <div class="w-full lg:w-[65%] space-y-4">
      <!-- Product Title -->
      <h1 class="text-xl font-semibold text-gray-900 leading-tight">
        {{ product?.title }}
      </h1>

      <!-- Product Description -->
      <p class="text-sm text-gray-600 leading-relaxed">
        {{ product?.description }}
      </p>

      <!-- Rating -->
      @if (product?.ratingsAverage) {
      <div class="flex items-center space-x-2">
        <div class="flex items-center space-x-1">
          @for (star of getStarArray(product?.ratingsQuantity ?? 0); track star;
          let i = $index) {
          <i class="fa-solid fa-star text-yellow-400"></i>
          }
        </div>
        <span class="text-sm font-medium text-gray-900">{{
          product?.ratingsAverage
        }}</span>
      </div>
      } @if (product?.quantity !== undefined) {
      <div class="text-sm text-gray-600">
        <strong>In Stock:</strong> {{ product?.quantity }} items
      </div>
      }
      <!-- Price -->
      <div class="text-2xl font-bold text-gray-900">
        {{ formatPriceInEGP(product?.price) }}
      </div>

      <!-- Add to Cart Button -->
      <button
        class="cursor-pointer btn w-full mx-auto bg-green-600 hover:bg-green-700 text-white px-5 py-3 rounded- font-medium"
        (click)="addToCart(product!._id)"
      >
        Add to cart
      </button>
    </div>
  </div>
</main>
